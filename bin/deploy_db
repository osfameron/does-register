#!/usr/bin/env perl
use strict; use warnings;
use lib 'lib';
use feature 'say';
use Getopt::Long;
use Data::Dumper;

use DoES::Register;
require t::lib::DoESTest;

my %opt;

GetOptions \%opt,
    'setup-fixtures';

my $app = DoES::Register->new;

my $db = $app->db;

$db->deploy;

if ($opt{'setup-fixtures'}) {
    say 'Setting up fixtures';
    DoESTest->setup_fixtures($db);
    say "You can run tests against this with:";
    say sprintf 'DOES_TEST_DSN=%s prove t', $app->dsn;
}

say "DONE";

